
The browser gets the Content Security Policy (CSP) through two main delivery methods
--> meta data
--> HTTP header

### 1. The HTTP Response Header (The "Standard" Way)

This is the most secure and common method. When you type a URL into your browser, the server sends back the website data. Included in the "invisible" metadata of that response is the `Content-Security-Policy` header.

+1

- **How it works:** The browser reads the header **before** it even looks at your HTML.
    
- **The Benefit:** Because it arrives first, the browser can set up its "bouncer" at the entrance, ensuring no malicious scripts are loaded even during the very first millisecond of page parsing.
    
- **The Code (Server-side):** `Content-Security-Policy: default-src 'self'; script-src https://trusted.com;`
    

---

### 2. The HTML `<meta>` Tag (The "Easy" Way)

If you don't have access to your server settings (for example, if you are using a site builder like GitHub Pages or a basic hosting service), you can put the policy directly inside your HTML code.

- **How it works:** You place a `<meta>` tag inside the `<head>` of your HTML document.
    
- **The Limitation:** The browser only sees this _after_ it starts reading the HTML. If you place it at the bottom of the page, some malicious code at the top might run before the browser even knows there is a policy!
    
- **The Code (Inside HTML):**
```
<head>
  <meta http-equiv="Content-Security-Policy" content="default-src 'self';">
</head>
```

-------

**Content Security Policy** (CSP) is a feature that helps to prevent or minimize the risk of certain types of security threats. It consists of a series of instructions from a website to a browser, which instruct the browser to place restrictions on the things that the code comprising the site is allowed to do.

For example, consider the following CSP:
```
Content-Security-Policy: default-src 'self'; img-src 'self' example.com
```

It sets two directives:

- the `default-src` directive is set to `'self'`
- the `img-src` directive is set to `'self' example.com`.

![[Pasted image 20260128184420.png]]

The first directive, `default-src`, tells the browser to load only resources that are same-origin with the document, unless other more specific directives set a different policy for other resource types. The second, `img-src`, tells the browser to load images that are same-origin or that are served from `example.com`


For example ,

An inline event handler:
```
<img
  onmouseover="console.log(`You've been hacked!`)"
  src="thumbnail.jpg"
  alt="" />
```

A CSP can provide protection against all of these. With a CSP, you can:

- define the permitted sources for JavaScript files and other resources, effectively blocking loads from `https://evil.example.com`
- disable inline script tags
- allow only script tags which have the correct [nonce](https://developer.mozilla.org/en-US/docs/Glossary/Nonce) or hash set
- disable inline event handlers
- disable `javascript:` URLs
- disable dangerous APIs like `eval()`


```
  "default-src 'self'; "

        "script-src 'self' https://cdn.tailwindcss.com https://www.youtube.com; "

        "style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdn.tailwindcss.com; "

        "font-src 'self' https://fonts.gstatic.com; "

        "img-src 'self' data:; "

        "child-src 'self' https://www.youtube.com; "

        "frame-src 'self' https://www.youtube.com; "

        "object-src 'none'; "

        "base-uri 'self'; "

        "form-action 'self';"
```

### 1. The Safety Net

- **`default-src 'self';`** This is the fallback rule. If you forget to define a rule for something (like a video or a plugin), the browser defaults to `'self'`, meaning it only allows resources from your own domain.
    

### 2. Scripts and Styles (The Appearance)

- **`script-src 'self' https://cdn.tailwindcss.com https://www.youtube.com;`** JavaScript can only be loaded from your own site, the Tailwind CDN, or YouTube. Anything else (like a script from `evil.example.com`) is blocked.
    
- **`style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdn.tailwindcss.com;`** Allows CSS from your site, Google Fonts, and Tailwind.
    
    > **Note:** `'unsafe-inline'` is included here because many CSS frameworks (like Tailwind) need to inject styles directly into the HTML to work.
    

### 3. Fonts and Images (The Media)

- **`font-src 'self' https://fonts.gstatic.com;`** Allows the actual font files to be downloaded from Google’s font servers.
    
- **`img-src 'self' data:;`** Allows images from your site. The `data:` part is important—it allows "Base64" images (images written as long strings of code directly in the HTML).
    

### 4. Embedding Content (The Frames)

- **`child-src` & `frame-src 'self' https://www.youtube.com;`** These two work together to allow you to embed YouTube videos (iframes) on your page. If a hacker tried to hide a malicious iframe on your site, the browser would stop it.
    

### 5. Locking Down the "Back Doors"

- **`object-src 'none';`** This is a major security win. It disables old, dangerous plugins like **Flash** or **Java Applets**. No one should use these in 2026.
    
- **`base-uri 'self';`** Prevents "Base Tag Hijacking." It ensures that any relative links on your page always point back to your own site.
    
- **`form-action 'self';`** Ensures that when a user submits a form (like a login or contact form), the data is **only** sent to your own server, not a hacker's database